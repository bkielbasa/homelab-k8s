grafana:
  enabled: true
  ingress:
    enabled: true
    ingressClassName: "nginx"
    annotations:
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
      cert-manager.io/cluster-issuer: "letsencrypt-prod"
    hosts:
      - grafana.klimczak.xyz
    path: /
    pathType: Prefix
    tls:
      - secretName: grafana-tls
        hosts:
          - grafana.klimczak.xyz
  
  sidecar:
    datasources:
      defaultDatasourceEnabled: false
      alertmanager:
        enabled: false
  
  datasources:
    datasources.yaml:
      apiVersion: 1
      datasources:
        - name: "Prometheus"
          type: prometheus
          uid: prometheus
          url: http://prometheus-kube-prometheus-prometheus.monitoring:9090/
          access: proxy
          isDefault: false
          jsonData:
            httpMethod: POST
            timeInterval: 30s
        - name: "Alertmanager"
          type: alertmanager
          uid: alertmanager
          url: http://prometheus-kube-prometheus-alertmanager.monitoring:9093/
          access: proxy
          jsonData:
            handleGrafanaManagedAlerts: false
            implementation: prometheus
        - name: "Loki"
          type: loki
          url: "http://loki.monitoring.svc.cluster.local:3100"
          access: proxy
          isDefault: false
          editable: true

prometheus-node-exporter:
  kind: DaemonSet

prometheus:
  prometheusSpec:
    serviceMonitorSelectorNilUsesHelmValues: false
    podMonitorSelectorNilUsesHelmValues: false
  prometheusSpec:
    additionalScrapeConfigs:
      - job_name: 'node-exporter'
        static_configs:
          - targets: ['192.168.1.29:9100','mail.klimczak.xyz:9100', 'lewski.com.pl:9100']
      - job_name: nginx
        static_configs:
          - targets: ['lewski.com.pl:9113']

      - job_name: mysql
        static_configs:
         - targets: ['lewski.com.pl:9104']

alertmanager:
  enabled: true

